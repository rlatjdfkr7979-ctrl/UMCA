<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>UMC Dooray Viewer Popup</title>
<style>
  body {
    margin: 0;
    padding: 0;
    font-family: 'Pretendard','Noto Sans KR',sans-serif;
    background: #f5f8fb;
    color: #222;
  }

  h1 {
    text-align: center;
    color: #004080;
    font-size: 24px;
    margin-top: 40px;
  }

  .menu {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    gap: 20px;
    margin: 40px 0;
  }

  .menu button {
    background: #004080;
    color: #fff;
    font-size: 16px;
    font-weight: 600;
    border: none;
    border-radius: 10px;
    padding: 14px 24px;
    cursor: pointer;
    transition: 0.2s;
  }

  .menu button:hover {
    background: #0066cc;
    transform: translateY(-2px);
  }

  .popup-overlay {
    display: none;
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(0,0,0,0.5);
    z-index: 9999;
    overflow-y: auto;
  }

  .popup-window {
    position: relative;
    background: #fff;
    width: 90%;
    max-width: 1400px;
    margin: 60px auto;
    border-radius: 12px;
    padding: 20px;
    box-shadow: 0 8px 28px rgba(0,0,0,0.25);
  }

  .popup-close {
    position: absolute;
    top: 12px; right: 18px;
    font-size: 28px;
    color: #666;
    cursor: pointer;
  }

  .popup-close:hover {
    color: #000;
  }

  iframe {
    width: 100%;
    height: 800px;
    border: 0;
    display: block;
  }

  .caption {
    text-align: center;
    margin-top: 10px;
    font-size: 16px;
    color: #333;
  }
</style>
</head>
<body>

  <h1>📚 전사 관리 대장 리스트</h1>

  <div class="menu">
    <button onclick="openPopup('📘 전사 교육관리', 'https://umc.gov-dooray.com/office/drives/4052235041576520491/files/4113287674040598452')">
      📘 전사 교육관리 대장
    </button>
    <button onclick="openPopup('📗 우편물 관리대장', 'https://umc.gov-dooray.com/office/drives/3971855165716167130/files/3980542803271944436')">
      📗 우편물 관리대장
    </button>
    <button onclick="openPopup('📗 공고대장', 'https://umc.gov-dooray.com/office/drives/3971855165716167130/files/4128344002780746730')">
      📗 공고대장
    </button>
    <button onclick="openPopup('📗 민원처리대장', 'https://umc.gov-dooray.com/office/drives/4026298892487886645/files/4026299303509425507')">
      📗 민원처리대장
    </button>
    <button onclick="openPopup('📗 도서관리대장', 'https://umc.gov-dooray.com/office/drives/3971855165716167130/files/4179910692485171746')">
      📗 도서관리대장
    </button>
  </div>

  <!-- 단일 팝업 구조 -->
  <div id="popup" class="popup-overlay" onclick="closePopup(event)">
    <div class="popup-window" onclick="event.stopPropagation()">
      <span class="popup-close" onclick="closePopup(event)">&times;</span>
      <iframe id="popupFrame" scrolling="yes"></iframe>
      <div class="caption" id="popupCaption"></div>
    </div>
  </div>

<script>
  function openPopup(title, url) {
    const popup = document.getElementById('popup');
    const frame = document.getElementById('popupFrame');
    const caption = document.getElementById('popupCaption');

    frame.src = url;          // 버튼 클릭 시 새로 로드
    caption.textContent = title; // 문서 제목 표시

    popup.style.display = 'block';
    document.body.style.overflow = 'hidden';
  }

  function closePopup(e) {
    const popup = document.getElementById('popup');
    popup.style.display = 'none';
    document.body.style.overflow = 'auto';

    // 닫을 때 iframe 비워주면 Dooray 리소스 정리됨
    document.getElementById('popupFrame').src = '';
  }
</script>

</body>
</html>
